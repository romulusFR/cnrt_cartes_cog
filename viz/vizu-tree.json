{
    "$schema": "https://vega.github.io/schema/vega/v3.0.json",
    "config": { "background": "#ffffff" },
    "width": 768,
    "height": 12288,
    "padding": 0,

    "data": [
        {
            "name": "tree",
            "url": "data/thesaurus.json",
            "transform": [
                { "type": "stratify", "key": "id", "parentKey": "parent" },
                {
                    "type": "tree",
                    "method": "tidy",
                    "size": [{ "signal": "height" }, { "signal": "width - 100" }],
                    "as": ["y", "x", "depth", "children"]
                }
            ]
        },
        {
            "name": "links",
            "source": "tree",
            "transform": [
                { "type": "treelinks", "key": "id" },
                {
                    "type": "linkpath",
                    "orient": "horizontal",
                    "shape": "diagonal"
                }
            ]
        }
    ],
    "scales": [{ "name": "color", "domain": [0, 398], "type": "sequential", "range": "ramp" }],
    "legends": [
        {
            "fill": "color",
            "orient": "left",
            "type": "gradient",
            "title": "Weight",
            "encode": {
                "labels": { "enter": { "text": { "signal": "datum.value * 100 + '%'" } } }
            }
        }
    ],
    "marks": [
        {
            "type": "path",
            "from": { "data": "links" },
            "encode": {
                "update": { "path": { "field": "path" }, "stroke": { "value": "#ccc" } }
            }
        },
        {
            "type": "symbol",
            "from": { "data": "tree" },
            "encode": {
                "enter": { "size": { "value": 256 }, "stroke": { "value": "#fff" } },
                "update": {
                    "x": { "field": "x" },
                    "y": { "field": "y" },
                    "fill": { "scale": "color", "field": "weight" }
                }
            }
        },
        {
            "type": "text",
            "from": { "data": "tree" },
            "encode": {
                "enter": {
                    "text": { "field": "name" },
                    "fontSize": { "value": 12 },
                    "baseline": { "value": "middle" }
                },
                "update": {
                    "x": { "field": "x" },
                    "y": { "field": "y" },
                    "dx": { "signal": "datum.children ? -10 : 10" },
                    "align": { "signal": "datum.children ? 'right' : 'left'" },
                    "opacity": 1
                }
            }
        }
    ]
}
